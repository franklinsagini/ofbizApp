<?xml version="1.0" encoding="UTF-8"?>
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-screen.xsd">

    <screen name="CommonImprestSetupDecorator">
        <section>
            <actions>
                <property-map resource="ImprestManagementUiLabels" map-name="uiLabelMap" global="true"/>
                 <set field="headerItem" value="setup"/><!-- this highlights the selected menu-item with name "setup" -->
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="pre-body">
                        <section>
                            <widgets>
                                <include-menu name="SetupTabBar" location="component://imprestmanagement/widget/ImprestManagementMenus.xml"/>
                            </widgets>
                        </section>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <section>
                                    <condition>
                                        <not>
                                            <if-empty field="parameters.supplierId"/>
                                        </not>
                                    </condition>
                                    <widgets>
                                        <container style="leftclear">
                                            <label style="h1" text="Supplier: ${supplierContext.supplierId} - ${supplierContext.name}"/>
                                        </container>
                                    </widgets>
                                </section>
                                <decorator-section-include name="body"/>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="CommonSurrenderableDecorator">
        <section>
            <actions>
                <property-map resource="ImprestManagementUiLabels" map-name="uiLabelMap" global="true"/>
                 <set field="headerItem" value="surrenderable"/><!-- this highlights the selected menu-item with name "surrenderable" -->
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="pre-body">
                        <section>
                            <widgets>
                                <include-menu name="SurrenderableTabBar" location="component://imprestmanagement/widget/ImprestManagementMenus.xml"/>
                            </widgets>
                        </section>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <section>
                                    <condition>
                                        <not>
                                            <if-empty field="parameters.surrenderableId"/>
                                        </not>
                                    </condition>
                                    <widgets>
                                        <container style="leftclear">
                                            <label style="h1" text="Imprest: ${imprestSurrenderableContext.surrenderableId} - ${imprestSurrenderableContext.approvalStatus}" />
                                        </container>
                                    </widgets>
                                </section>
                                <decorator-section-include name="body"/>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>


    <screen name="main">
        <section>
            <actions>
                <set field="headerItem" value="main"/><!-- this highlights the selected menu-item with name "main" -->
            </actions>
            <widgets>
                <decorator-screen name="ImprestManagementCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="setup">
        <section>
            <actions>
                <set field="tabButtonItem" value="accountsetup"/>
                <entity-one entity-name="ImprestAccount" value-field="imprestAccountContext"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonImprestSetupDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section>
                            <condition>
                                <if-has-permission permission="IMPRESTMANAGEMENT" action="IMPRESTMANAGEMENT_CREATE"/>
                            </condition>
                            <widgets>
                                <screenlet title="Imprest Management: Accounts Setup">
                                    <include-form name="EditImprestAccount" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                            <fail-widgets>
                                <label style="h3">${uiLabelMap.ImprestManagementViewPermissionError}</label>
                            </fail-widgets>
                        </section>
                        <section name="search-results">
                            <widgets>
                                <screenlet title="Imprest Management: Imprests Accounts List">
                                    <include-form name="ImprestAccountList" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="perdiemsetup">
        <section>
            <actions>
                <set field="tabButtonItem" value="perdiemsetup"/>
                <entity-one entity-name="ImprestPerDiemSetup" value-field="perDiemContext"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonImprestSetupDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section>
                            <condition>
                                <if-has-permission permission="IMPRESTMANAGEMENT" action="IMPRESTMANAGEMENT_CREATE"/>
                            </condition>
                            <widgets>
                                <screenlet title="Imprest Management: Per Diem Setup">
                                    <include-form name="EditPerDiemSetup" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                            <fail-widgets>
                                <label style="h3">${uiLabelMap.ImprestManagementViewPermissionError}</label>
                            </fail-widgets>
                        </section>
                        <section name="search-results">
                            <widgets>
                                <screenlet title="Imprest Management: Per Diem Setup List">
                                    <include-form name="PerDiemSetupList" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="destinationssetup">
        <section>
            <actions>
                <set field="tabButtonItem" value="destinationssetup"/>
                <entity-one entity-name="ImprestDestination" value-field="imprestDestinationContext"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonImprestSetupDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section>
                            <condition>
                                <if-has-permission permission="IMPRESTMANAGEMENT" action="IMPRESTMANAGEMENT_CREATE"/>
                            </condition>
                            <widgets>
                                <screenlet title="Imprest Management: Destination Setup">
                                    <include-form name="EditImprestDestination" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                            <fail-widgets>
                                <label style="h3">${uiLabelMap.ImprestManagementViewPermissionError}</label>
                            </fail-widgets>
                        </section>
                        <section name="search-results">
                            <widgets>
                                <screenlet title="Imprest Management: Imprests Destination List">
                                    <include-form name="ImprestDestinationList" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="findSurrenderable">
        <section>
            <actions>
                <set field="tabButtonItem" value="find"/>
                <set field="titleProperty" value="Find Surrenderable Imprest"/>
                <set field="surrenderCtx" from-field="parameters" />
            </actions>
            <widgets>
                <decorator-screen name="CommonSurrenderableDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                                    <decorator-section name="menu-bar">
                                        <container style="button-bar">
                                            <link target="newSurrenderable" text="${uiLabelMap.CommonCreateNew}" style="buttontext create"/>
                                        </container>
                                    </decorator-section>
                                    <decorator-section name="search-options">
                                        <include-form name="FindSurrenderable" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                    </decorator-section>
                                    <decorator-section name="search-results">
                                        <include-form name="FindSurrenderableList" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                    </decorator-section>
                                </decorator-screen>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="newSurrenderable">
        <section>
            <actions>
                <set field="titleProperty" value="AccountingNewPaymentOutgoing"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonSurrenderableDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <screenlet title="Imprest Management: Surrenderable Imprest">
                                    <include-form name="newSurrenderable" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="editSurrenderable">
        <section>
            <actions>
                <set field="surrenderableId" value="parameters.surrenderableId"/>
                 <set field="previousParams" from-field="sessionAttributes._PREVIOUS_PARAMS_"/>
                <entity-one entity-name="ImprestSurrenderable" value-field="imprestSurrenderableContext"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonSurrenderableDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <screenlet title="Imprest Management: Surrenderable Imprest">
                                    <include-form name="EditSurrenderable" location="component://imprestmanagement/widget/ImprestManagementForms.xml"/>
                                </screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="perdiem">
        <section>
            <actions>
                <set field="headerItem" value="perdiem"/><!-- this highlights the selected menu-item with name "perdiem" -->
            </actions>
            <widgets>
                <decorator-screen name="ImprestManagementCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="pettycash">
        <section>
            <actions>
                <set field="headerItem" value="pettycash"/><!-- this highlights the selected menu-item with name "pettycash" -->
            </actions>
            <widgets>
                <decorator-screen name="ImprestManagementCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

</screens>
