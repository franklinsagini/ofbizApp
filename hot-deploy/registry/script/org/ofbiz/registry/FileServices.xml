<?xml version="1.0" encoding="UTF-8"?>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->

<simple-methods xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/simple-methods-v2.xsd">

        <!-- User -->
        
        
        
        <simple-method method-name="createfiletype" short-description="Create File Type">
            <make-value entity-name="FileType" value-field="newEntity"/>
             <set-pk-fields map="parameters" value-field="newEntity"/>
            <set-nonpk-fields map="parameters" value-field="newEntity"/>
            <sequenced-id sequence-name="FileType" field="fileTypeId"/>
           
            <set from-field="fileTypeId" field="newEntity.fileTypeId"/>
            <create-value value-field="newEntity"/>
    </simple-method>
    
     <simple-method method-name="createFileBook" short-description="Create File Book">
            <make-value entity-name="FileBooks" value-field="newEntity"/>
             <set-pk-fields map="parameters" value-field="newEntity"/>
            <set-nonpk-fields map="parameters" value-field="newEntity"/>
            <sequenced-id sequence-name="FileBooks" field="fileBookId"/>
            <set from-field="fileBookId" field="newEntity.fileBookId"/>
            <set value="FBK-${newEntity.fileBookId}-${newEntity.firstName}" field="newEntity.FolioNo" />
            <set value="${userLogin.partyId}" field="newEntity.Creator" />
            <create-value value-field="newEntity"/>
    </simple-method>
    
     <simple-method method-name="createFiless" short-description="Create File ">
            <make-value entity-name="Files" value-field="newEntity"/>
             <set-pk-fields map="parameters" value-field="newEntity"/>
            <set-nonpk-fields map="parameters" value-field="newEntity"/>
            <sequenced-id sequence-name="Files" field="FileId"/>
            <set from-field="FileId" field="newEntity.FileId"/>
            
            <set value="MFL-${newEntity.DocumentId}" field="newEntity.FolioNo" />
            <create-value value-field="newEntity"/>
    </simple-method>
    
      <simple-method method-name="requestfiles" short-description="request File ">
            <make-value entity-name="FilesRequest" value-field="newEntity"/>
             <set-pk-fields map="parameters" value-field="newEntity"/>
            <set-nonpk-fields map="parameters" value-field="newEntity"/>
            <sequenced-id sequence-name="FilesRequest" field="RequestId"/>
            <set from-field="RequestId" field="newEntity.RequestId"/>
            <create-value value-field="newEntity"/>
    </simple-method>
    
     <simple-method method-name="createfilelocation" short-description="Create File location">
            <make-value entity-name="fileLocations" value-field="newEntity"/>
             <set-pk-fields map="parameters" value-field="newEntity"/>
            <set-nonpk-fields map="parameters" value-field="newEntity"/>
            <sequenced-id sequence-name="fileLocations" field="locationId"/>
           
            <set from-field="locationId" field="newEntity.locationId"/>
            <create-value value-field="newEntity"/>
    </simple-method>
    
    
   
    
    
    
    <simple-method method-name="deleteEstate" short-description="Remove an estate">
        <set field="estateId" from-field="parameters.estateId"/>
        <entity-one entity-name="Estate" value-field="lookedUpValue"/>
        <remove-value value-field="lookedUpValue"/>
    </simple-method>

    
    
    <simple-method method-name="updateEstate" short-description="Update an existing Budget">
        <entity-one entity-name="Estate" value-field="lookedUpValue"/>
        <set-nonpk-fields map="parameters" value-field="lookedUpValue"/>
        <set-pk-fields value-field="lookedUpValue" map="parameters"/>
        <store-value value-field="lookedUpValue"/>
       
    </simple-method>
    
    
    
    

   

    <simple-method method-name="getInvoice" short-description="Retrieve an invoice and the items">
        <!-- find the invoice record -->
        <make-value value-field="lookupPKMap" entity-name="Invoice"/>
        <set-pk-fields map="parameters" value-field="lookupPKMap"/>

        <find-by-primary-key entity-name="Invoice" map="lookupPKMap" value-field="invoiceValue"/>
        <field-to-result field="invoiceValue" result-name="invoice"/>
        <!-- and the items -->
        <get-related value-field="invoiceValue" relation-name="InvoiceItem" list="invoiceItemValues"/>
        <field-to-result field="invoiceItemValues" result-name="invoiceItems"/>
    </simple-method>


   
    <simple-method method-name="createNewOrder" short-description="Create Order">
        <now-timestamp field="nowTimestamp"/>
        <make-value entity-name="Order" value-field="newEntity"/>
        <!-- set the order entry date -->
        <set from-field="nowTimestamp" field="newEntity.entryDate"/>
        <!-- Set order date if not provided -->
        <if-empty field="parameters.orderDate">
            <set from-field="nowTimestamp" field="parameters.orderDate"/>
        </if-empty>
        <!-- Set order type -->
        <set value="PURCHASE_ORDER" field="newEntity.orderTypeId" />
        <!-- Set sales Channel -->
        <set value="UNKNWN_SALES_CHANNEL" field="newEntity.salesChannelEnumId" />
        <!-- Set the prepared by using the currently logged in user -->
        <set value="${userLogin.partyId}" field="newEntity.createdBy" />
        <!-- Set Status of the order -->
        <set value="OPEN_ORDER" field="newEntity.status" />
        <set-pk-fields map="parameters" value-field="newEntity"/>
        <set-nonpk-fields map="parameters" value-field="newEntity"/>
        <sequenced-id sequence-name="Order" field="orderId"/>
        <now-timestamp field="newEntity.createdDate"/>
        <set from-field="orderId" field="newEntity.orderId"/>
        <!--  set field="entity.loanStatus" value="DRAFT"/ -->
        <!-- set field="productType" value="Loan"/ -->
        <create-value value-field="newEntity"/>
    </simple-method>

    <!-- Order Line Creation Service-->
    <simple-method method-name="createOrderLine" short-description="Create OrderLine">
        <now-timestamp field="nowTimestamp"/>
        <make-value entity-name="OrderLine" value-field="newEntity"/>
        <!-- Set OrderItemTypeId -->
        <set value="PRODUCT_ORDER_ITEM" field="newEntity.orderItemTypeId" />
        <set-pk-fields map="parameters" value-field="newEntity"/>
        <set-nonpk-fields map="parameters" value-field="newEntity"/>
        <sequenced-id sequence-name="OrderLine" field="orderLineSeqId"/>
        <set from-field="orderLineSeqId" field="newEntity.orderLineSeqId"/>
        <!--  set field="entity.loanStatus" value="DRAFT"/ -->
        <!-- set field="productType" value="Loan"/ -->
        <create-value value-field="newEntity"/>
    </simple-method>


</simple-methods>
